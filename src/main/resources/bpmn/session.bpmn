<?xml version="1.0" encoding="UTF-8"?>
<bpmn:definitions xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="Definitions_1" targetNamespace="http://bpmn.io/schema/bpmn" exporter="Camunda Modeler" exporterVersion="1.10.0">
  <bpmn:collaboration id="Collaboration_1kjx4nt">
    <bpmn:documentation>Store active session</bpmn:documentation>
    <bpmn:participant id="Participant_0mlpt32" name="Borders System" processRef="session" />
    <bpmn:participant id="Participant_00gisla" name="UI " />
    <bpmn:participant id="Participant_0tfi0ju" name="Keycloak Private Realm" />
    <bpmn:messageFlow id="MessageFlow_0mzbw92" name="Form submission" sourceRef="Participant_00gisla" targetRef="StartEvent_1" />
    <bpmn:messageFlow id="MessageFlow_1r3bp03" name="Remove user session&#10;&#10;" sourceRef="Task_1y8oyjy" targetRef="Participant_0tfi0ju" />
  </bpmn:collaboration>
  <bpmn:process id="session" name="Session" isExecutable="false">
    <bpmn:startEvent id="StartEvent_1" name="Remove session request submitted">
      <bpmn:outgoing>SequenceFlow_1cnfedv</bpmn:outgoing>
    </bpmn:startEvent>
    <bpmn:serviceTask id="Task_1f7bevv" name="Store active session">
      <bpmn:incoming>SequenceFlow_1cnfedv</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_0927hu5</bpmn:outgoing>
      <bpmn:dataOutputAssociation id="DataOutputAssociation_01356zx">
        <bpmn:targetRef>DataStoreReference_0qzm7dy</bpmn:targetRef>
      </bpmn:dataOutputAssociation>
    </bpmn:serviceTask>
    <bpmn:intermediateCatchEvent id="IntermediateThrowEvent_1bpvsqo" name="Session Expiry">
      <bpmn:incoming>SequenceFlow_0927hu5</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_1tivuep</bpmn:outgoing>
      <bpmn:timerEventDefinition>
        <bpmn:timeDate xsi:type="bpmn:tFormalExpression">${activeSession.endTime}</bpmn:timeDate>
      </bpmn:timerEventDefinition>
    </bpmn:intermediateCatchEvent>
    <bpmn:parallelGateway id="ExclusiveGateway_078rz9s">
      <bpmn:incoming>SequenceFlow_1tivuep</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_01bw0zx</bpmn:outgoing>
      <bpmn:outgoing>SequenceFlow_0jojx69</bpmn:outgoing>
    </bpmn:parallelGateway>
    <bpmn:parallelGateway id="ExclusiveGateway_0wabrgh">
      <bpmn:incoming>SequenceFlow_0n0uj4i</bpmn:incoming>
      <bpmn:incoming>SequenceFlow_0d8vrvl</bpmn:incoming>
      <bpmn:incoming>SequenceFlow_18lf1zg</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_0hjuupb</bpmn:outgoing>
    </bpmn:parallelGateway>
    <bpmn:serviceTask id="Task_1y8oyjy" name="Remove keycloak user session">
      <bpmn:incoming>SequenceFlow_0vw5fy7</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_0n0uj4i</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:endEvent id="EndEvent_0cjilnz" name="Active session removed">
      <bpmn:incoming>SequenceFlow_0hjuupb</bpmn:incoming>
    </bpmn:endEvent>
    <bpmn:exclusiveGateway id="ExclusiveGateway_0z7d5un" name="Has keycloak session?">
      <bpmn:incoming>SequenceFlow_0jojx69</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_0vw5fy7</bpmn:outgoing>
      <bpmn:outgoing>SequenceFlow_18lf1zg</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:serviceTask id="Task_0f5abt8" name="Remove active team session">
      <bpmn:incoming>SequenceFlow_01bw0zx</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_0d8vrvl</bpmn:outgoing>
      <bpmn:dataOutputAssociation id="DataOutputAssociation_0fwhjkz">
        <bpmn:targetRef>DataStoreReference_0qzm7dy</bpmn:targetRef>
      </bpmn:dataOutputAssociation>
    </bpmn:serviceTask>
    <bpmn:sequenceFlow id="SequenceFlow_1cnfedv" sourceRef="StartEvent_1" targetRef="Task_1f7bevv" />
    <bpmn:sequenceFlow id="SequenceFlow_0927hu5" sourceRef="Task_1f7bevv" targetRef="IntermediateThrowEvent_1bpvsqo" />
    <bpmn:sequenceFlow id="SequenceFlow_1tivuep" sourceRef="IntermediateThrowEvent_1bpvsqo" targetRef="ExclusiveGateway_078rz9s" />
    <bpmn:sequenceFlow id="SequenceFlow_01bw0zx" sourceRef="ExclusiveGateway_078rz9s" targetRef="Task_0f5abt8" />
    <bpmn:sequenceFlow id="SequenceFlow_0jojx69" sourceRef="ExclusiveGateway_078rz9s" targetRef="ExclusiveGateway_0z7d5un" />
    <bpmn:sequenceFlow id="SequenceFlow_0n0uj4i" sourceRef="Task_1y8oyjy" targetRef="ExclusiveGateway_0wabrgh" />
    <bpmn:sequenceFlow id="SequenceFlow_0d8vrvl" sourceRef="Task_0f5abt8" targetRef="ExclusiveGateway_0wabrgh" />
    <bpmn:sequenceFlow id="SequenceFlow_18lf1zg" name="no" sourceRef="ExclusiveGateway_0z7d5un" targetRef="ExclusiveGateway_0wabrgh" />
    <bpmn:sequenceFlow id="SequenceFlow_0hjuupb" sourceRef="ExclusiveGateway_0wabrgh" targetRef="EndEvent_0cjilnz" />
    <bpmn:sequenceFlow id="SequenceFlow_0vw5fy7" name="yes" sourceRef="ExclusiveGateway_0z7d5un" targetRef="Task_1y8oyjy" />
    <bpmn:dataStoreReference id="DataStoreReference_0qzm7dy" name="Session data store" />
    <bpmn:textAnnotation id="TextAnnotation_03yyvyg">    <bpmn:text>Remove session after specified time</bpmn:text>
</bpmn:textAnnotation>
    <bpmn:association id="Association_14dh0bf" sourceRef="IntermediateThrowEvent_1bpvsqo" targetRef="TextAnnotation_03yyvyg" />
  </bpmn:process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_1">
    <bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="Collaboration_1kjx4nt">
      <bpmndi:BPMNShape id="Participant_0mlpt32_di" bpmnElement="Participant_0mlpt32">
        <dc:Bounds x="179" y="177" width="1002" height="413" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="_BPMNShape_StartEvent_2" bpmnElement="StartEvent_1">
        <dc:Bounds x="246" y="315" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="220" y="351" width="88" height="25" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Participant_1nvmvyi_di" bpmnElement="Participant_00gisla">
        <dc:Bounds x="179" y="-99" width="395" height="185" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="MessageFlow_0mzbw92_di" bpmnElement="MessageFlow_0mzbw92">
        <di:waypoint xsi:type="dc:Point" x="265" y="86" />
        <di:waypoint xsi:type="dc:Point" x="265" y="202" />
        <di:waypoint xsi:type="dc:Point" x="265" y="315" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="275" y="124" width="84" height="12" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_1cnfedv_di" bpmnElement="SequenceFlow_1cnfedv">
        <di:waypoint xsi:type="dc:Point" x="282" y="333" />
        <di:waypoint xsi:type="dc:Point" x="321" y="333" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="257" y="312" width="90" height="13" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="ServiceTask_0ukz2ic_di" bpmnElement="Task_1f7bevv">
        <dc:Bounds x="321" y="293" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="SequenceFlow_0927hu5_di" bpmnElement="SequenceFlow_0927hu5">
        <di:waypoint xsi:type="dc:Point" x="421" y="333" />
        <di:waypoint xsi:type="dc:Point" x="461" y="333" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="396" y="312" width="90" height="13" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="IntermediateCatchEvent_05hwa8g_di" bpmnElement="IntermediateThrowEvent_1bpvsqo">
        <dc:Bounds x="461" y="315" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="444" y="354" width="73" height="13" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="EndEvent_0cjilnz_di" bpmnElement="EndEvent_0cjilnz">
        <dc:Bounds x="1085" y="315" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1067" y="354" width="71" height="24" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="ServiceTask_018mejv_di" bpmnElement="Task_0f5abt8">
        <dc:Bounds x="681" y="413" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="ParallelGateway_1rft1lo_di" bpmnElement="ExclusiveGateway_078rz9s">
        <dc:Bounds x="518" y="308" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="498" y="360" width="90" height="13" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="SequenceFlow_1tivuep_di" bpmnElement="SequenceFlow_1tivuep">
        <di:waypoint xsi:type="dc:Point" x="497" y="333" />
        <di:waypoint xsi:type="dc:Point" x="518" y="333" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="463" y="311" width="90" height="13" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_01bw0zx_di" bpmnElement="SequenceFlow_01bw0zx">
        <di:waypoint xsi:type="dc:Point" x="543" y="358" />
        <di:waypoint xsi:type="dc:Point" x="543" y="453" />
        <di:waypoint xsi:type="dc:Point" x="681" y="453" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="513" y="399" width="90" height="13" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_0n0uj4i_di" bpmnElement="SequenceFlow_0n0uj4i">
        <di:waypoint xsi:type="dc:Point" x="874" y="244" />
        <di:waypoint xsi:type="dc:Point" x="909" y="244" />
        <di:waypoint xsi:type="dc:Point" x="909" y="308" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="847" y="223" width="90" height="13" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="ParallelGateway_1qfc87d_di" bpmnElement="ExclusiveGateway_0wabrgh">
        <dc:Bounds x="884" y="308" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="864" y="361" width="90" height="13" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="SequenceFlow_0d8vrvl_di" bpmnElement="SequenceFlow_0d8vrvl">
        <di:waypoint xsi:type="dc:Point" x="781" y="453" />
        <di:waypoint xsi:type="dc:Point" x="909" y="453" />
        <di:waypoint xsi:type="dc:Point" x="909" y="358" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="800" y="432" width="90" height="13" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_0hjuupb_di" bpmnElement="SequenceFlow_0hjuupb">
        <di:waypoint xsi:type="dc:Point" x="934" y="333" />
        <di:waypoint xsi:type="dc:Point" x="1085" y="333" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="965" y="312" width="90" height="13" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="ServiceTask_0nxitaq_di" bpmnElement="Task_1y8oyjy">
        <dc:Bounds x="774" y="204" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="TextAnnotation_03yyvyg_di" bpmnElement="TextAnnotation_03yyvyg">
        <dc:Bounds x="429" y="231" width="100" height="54" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="Association_14dh0bf_di" bpmnElement="Association_14dh0bf">
        <di:waypoint xsi:type="dc:Point" x="479" y="315" />
        <di:waypoint xsi:type="dc:Point" x="479" y="285" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="Participant_08b3ale_di" bpmnElement="Participant_0tfi0ju">
        <dc:Bounds x="630" y="-99" width="347" height="189" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="ExclusiveGateway_0z7d5un_di" bpmnElement="ExclusiveGateway_0z7d5un" isMarkerVisible="true">
        <dc:Bounds x="639" y="219" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="628" y="185" width="66" height="25" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="SequenceFlow_0jojx69_di" bpmnElement="SequenceFlow_0jojx69">
        <di:waypoint xsi:type="dc:Point" x="543" y="308" />
        <di:waypoint xsi:type="dc:Point" x="543" y="244" />
        <di:waypoint xsi:type="dc:Point" x="639" y="244" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="513" y="270" width="90" height="13" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_0vw5fy7_di" bpmnElement="SequenceFlow_0vw5fy7">
        <di:waypoint xsi:type="dc:Point" x="689" y="244" />
        <di:waypoint xsi:type="dc:Point" x="774" y="244" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="723" y="222" width="18" height="13" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_18lf1zg_di" bpmnElement="SequenceFlow_18lf1zg">
        <di:waypoint xsi:type="dc:Point" x="664" y="269" />
        <di:waypoint xsi:type="dc:Point" x="664" y="333" />
        <di:waypoint xsi:type="dc:Point" x="884" y="333" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="673" y="294" width="13" height="12" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="MessageFlow_1r3bp03_di" bpmnElement="MessageFlow_1r3bp03">
        <di:waypoint xsi:type="dc:Point" x="824" y="204" />
        <di:waypoint xsi:type="dc:Point" x="824" y="90" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="835" y="120" width="66" height="49" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="DataStoreReference_0qzm7dy_di" bpmnElement="DataStoreReference_0qzm7dy">
        <dc:Bounds x="418.1311084624553" y="507.63766388557804" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="411" y="561" width="64" height="24" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="DataOutputAssociation_01356zx_di" bpmnElement="DataOutputAssociation_01356zx">
        <di:waypoint xsi:type="dc:Point" x="371" y="373" />
        <di:waypoint xsi:type="dc:Point" x="371" y="539" />
        <di:waypoint xsi:type="dc:Point" x="418" y="539" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="DataOutputAssociation_0fwhjkz_di" bpmnElement="DataOutputAssociation_0fwhjkz">
        <di:waypoint xsi:type="dc:Point" x="731" y="493" />
        <di:waypoint xsi:type="dc:Point" x="731" y="531" />
        <di:waypoint xsi:type="dc:Point" x="468" y="531" />
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</bpmn:definitions>
